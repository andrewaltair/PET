(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8643],{7002:function(t,e,s){Promise.resolve().then(s.bind(s,3669))},3669:function(t,e,s){"use strict";s.r(e),s.d(e,{default:function(){return g}});var n=s(7821);s(8078);var i=s(8504),r=s(9926),a=s(1392),o=s(9008),c=s(6066),u=s(4852),l=s(3842),d=s(8006),h=s(2547),m=s(5813),p=s(2133),x=s(2531);let f=(0,s(8322).Z)("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);function y(){var t,e,s;let{user:c}=(0,r.a)(),y=(0,i.useRouter)(),{data:g,isPending:v,error:b}=(0,a.B9)(),j=(0,a.Wd)(),N=async()=>{try{let t=await j.mutateAsync();window.location.href=t.onboardingUrl}catch(t){console.error("Failed to create Stripe onboarding:",t)}};if((null==c?void 0:c.role)!==o.UserRole.PROVIDER)return(0,n.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"text-6xl mb-4",children:"\uD83D\uDEAB"}),(0,n.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Access Denied"}),(0,n.jsx)("p",{className:"text-gray-600 mb-6",children:"Only service providers can manage payment settings."}),(0,n.jsx)(l.z,{onClick:()=>y.push("/dashboard"),children:"Back to Dashboard"})]})});if(v)return(0,n.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,n.jsx)(u.T,{size:"lg"})});if(b)return(0,n.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)(m.Z,{className:"mx-auto h-12 w-12 text-red-500 mb-4"}),(0,n.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Error Loading Payment Settings"}),(0,n.jsx)("p",{className:"text-gray-600 mb-6",children:b instanceof Error?b.message:"Failed to load payment settings"}),(0,n.jsx)(l.z,{onClick:()=>y.push("/dashboard"),children:"Back to Dashboard"})]})});let w=null!==(s=null==g?void 0:null===(t=g.data)||void 0===t?void 0:t.onboardingComplete)&&void 0!==s&&s,C=!!(null==g?void 0:null===(e=g.data)||void 0===e?void 0:e.stripeAccountId);return(0,n.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,n.jsxs)("div",{className:"max-w-4xl mx-auto px-4",children:[(0,n.jsxs)("div",{className:"mb-8",children:[(0,n.jsx)("button",{onClick:()=>y.push("/dashboard"),className:"text-blue-600 hover:text-blue-800 mb-4 inline-block",children:"â† Back to Dashboard"}),(0,n.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Payment Settings"}),(0,n.jsx)("p",{className:"text-gray-600 mt-2",children:"Manage your Stripe account and payment preferences"})]}),(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)(d.Zb,{children:[(0,n.jsxs)(d.Ol,{children:[(0,n.jsxs)(d.ll,{className:"flex items-center gap-2",children:[(0,n.jsx)(p.Z,{className:"h-5 w-5"}),"Stripe Account Status"]}),(0,n.jsx)(d.SZ,{children:"Connect your Stripe account to receive payments from customers"})]}),(0,n.jsxs)(d.aY,{children:[w?(0,n.jsxs)("div",{className:"flex items-center gap-3 p-4 bg-green-50 border border-green-200 rounded-lg",children:[(0,n.jsx)(x.Z,{className:"h-5 w-5 text-green-600"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"font-medium text-green-900",children:"Stripe Account Connected"}),(0,n.jsx)("p",{className:"text-sm text-green-700",children:"Your account is fully set up and ready to receive payments."})]})]}):C?(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)(h.bZ,{children:[(0,n.jsx)(m.Z,{className:"h-4 w-4"}),(0,n.jsx)(h.X,{children:"Your Stripe account is created but onboarding is not complete. Please complete the onboarding process to start receiving payments."})]}),(0,n.jsx)(l.z,{onClick:N,disabled:j.isPending,className:"w-full",children:j.isPending?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(u.T,{size:"sm",className:"mr-2"}),"Setting up..."]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(f,{className:"mr-2 h-4 w-4"}),"Complete Stripe Onboarding"]})})]}):(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)(h.bZ,{children:[(0,n.jsx)(m.Z,{className:"h-4 w-4"}),(0,n.jsx)(h.X,{children:"You need to connect your Stripe account to receive payments from customers. This is required to accept bookings and get paid."})]}),(0,n.jsx)(l.z,{onClick:N,disabled:j.isPending,className:"w-full",children:j.isPending?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(u.T,{size:"sm",className:"mr-2"}),"Connecting..."]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(f,{className:"mr-2 h-4 w-4"}),"Connect Stripe Account"]})})]}),j.error&&(0,n.jsxs)(h.bZ,{className:"mt-4",children:[(0,n.jsx)(m.Z,{className:"h-4 w-4"}),(0,n.jsxs)(h.X,{className:"text-red-600",children:["Failed to connect Stripe account: ",j.error.message]})]})]})]}),(0,n.jsxs)(d.Zb,{children:[(0,n.jsxs)(d.Ol,{children:[(0,n.jsx)(d.ll,{children:"Payment Information"}),(0,n.jsx)(d.SZ,{children:"How payments work on our platform"})]}),(0,n.jsxs)(d.aY,{children:[(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center py-2 border-b",children:[(0,n.jsx)("span",{className:"text-sm font-medium",children:"Platform Commission"}),(0,n.jsx)("span",{className:"text-sm text-gray-600",children:"10%"})]}),(0,n.jsxs)("div",{className:"flex justify-between items-center py-2 border-b",children:[(0,n.jsx)("span",{className:"text-sm font-medium",children:"Provider Receives"}),(0,n.jsx)("span",{className:"text-sm text-gray-600",children:"90%"})]}),(0,n.jsxs)("div",{className:"flex justify-between items-center py-2",children:[(0,n.jsx)("span",{className:"text-sm font-medium",children:"Payout Schedule"}),(0,n.jsx)("span",{className:"text-sm text-gray-600",children:"Daily"})]})]}),(0,n.jsx)("p",{className:"text-xs text-gray-500 mt-4",children:"Payments are processed securely through Stripe. Funds are transferred to your connected bank account according to your payout schedule."})]})]})]})]})})}function g(){return(0,n.jsx)(c.i,{children:(0,n.jsx)(y,{})})}},4852:function(t,e,s){"use strict";s.d(e,{T:function(){return i}});var n=s(7821);function i(t){let{size:e="md",className:s=""}=t;return(0,n.jsx)("div",{className:"flex justify-center items-center ".concat(s),children:(0,n.jsx)("div",{className:"".concat({sm:"w-4 h-4",md:"w-8 h-8",lg:"w-12 h-12"}[e]," border-2 border-gray-300 border-t-blue-600 rounded-full animate-spin")})})}s(8078)},6066:function(t,e,s){"use strict";s.d(e,{i:function(){return a}});var n=s(7821),i=s(8078),r=s(9926);function a(t){let{children:e}=t,{isAuthenticated:s,isLoading:a}=(0,r.a)();return(console.log("[ProtectedRoute DEBUG] Render - isAuthenticated:",s,"isLoading:",a),(0,i.useEffect)(()=>{console.log("[ProtectedRoute DEBUG] useEffect triggered - isLoading:",a,"isAuthenticated:",s),a||s?!a&&s&&console.log("[ProtectedRoute DEBUG] User is authenticated, allowing access"):(console.log("[ProtectedRoute DEBUG] Not authenticated, redirecting to /login"),window.location.href="/login")},[s,a]),a)?(console.log("[ProtectedRoute DEBUG] Still loading, showing loading spinner"),(0,n.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,n.jsx)("p",{className:"text-gray-600",children:"Loading..."})]})})):s?(console.log("[ProtectedRoute DEBUG] Rendering protected content"),(0,n.jsx)(n.Fragment,{children:e})):(console.log("[ProtectedRoute DEBUG] Not authenticated, returning null"),null)}},2547:function(t,e,s){"use strict";s.d(e,{X:function(){return u},bZ:function(){return c}});var n=s(7821),i=s(8078),r=s(898),a=s(7211);let o=(0,r.j)("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),c=i.forwardRef((t,e)=>{let{className:s,variant:i,...r}=t;return(0,n.jsx)("div",{ref:e,role:"alert",className:(0,a.cn)(o({variant:i}),s),...r})});c.displayName="Alert",i.forwardRef((t,e)=>{let{className:s,...i}=t;return(0,n.jsx)("h5",{ref:e,className:(0,a.cn)("mb-1 font-medium leading-none tracking-tight",s),...i})}).displayName="AlertTitle";let u=i.forwardRef((t,e)=>{let{className:s,...i}=t;return(0,n.jsx)("div",{ref:e,className:(0,a.cn)("text-sm [&_p]:leading-relaxed",s),...i})});u.displayName="AlertDescription"},8006:function(t,e,s){"use strict";s.d(e,{Ol:function(){return o},SZ:function(){return u},Zb:function(){return a},aY:function(){return l},eW:function(){return d},ll:function(){return c}});var n=s(7821),i=s(8078),r=s(7211);let a=i.forwardRef((t,e)=>{let{className:s,...i}=t;return(0,n.jsx)("div",{ref:e,className:(0,r.cn)("rounded-xl border bg-card text-card-foreground shadow",s),...i})});a.displayName="Card";let o=i.forwardRef((t,e)=>{let{className:s,...i}=t;return(0,n.jsx)("div",{ref:e,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",s),...i})});o.displayName="CardHeader";let c=i.forwardRef((t,e)=>{let{className:s,...i}=t;return(0,n.jsx)("div",{ref:e,className:(0,r.cn)("font-semibold leading-none tracking-tight",s),...i})});c.displayName="CardTitle";let u=i.forwardRef((t,e)=>{let{className:s,...i}=t;return(0,n.jsx)("div",{ref:e,className:(0,r.cn)("text-sm text-muted-foreground",s),...i})});u.displayName="CardDescription";let l=i.forwardRef((t,e)=>{let{className:s,...i}=t;return(0,n.jsx)("div",{ref:e,className:(0,r.cn)("p-6 pt-0",s),...i})});l.displayName="CardContent";let d=i.forwardRef((t,e)=>{let{className:s,...i}=t;return(0,n.jsx)("div",{ref:e,className:(0,r.cn)("flex items-center p-6 pt-0",s),...i})});d.displayName="CardFooter"},1392:function(t,e,s){"use strict";s.d(e,{B9:function(){return o},Wd:function(){return c},aS:function(){return u}});var n=s(5427),i=s(8191),r=s(8683),a=s(6963);function o(){return(0,n.a)({queryKey:["stripe","account-status"],queryFn:async()=>(await a.hi.get("/stripe/connect/account-status")).data,enabled:!0})}function c(){let t=(0,i.NL)();return(0,r.D)({mutationFn:async()=>(await a.hi.post("/stripe/connect/onboard")).data.data,onSuccess:()=>{t.invalidateQueries({queryKey:["stripe","account-status"]})}})}function u(){return(0,r.D)({mutationFn:async t=>(await a.hi.post("/bookings/".concat(t,"/create-payment-intent"))).data.data})}},5813:function(t,e,s){"use strict";s.d(e,{Z:function(){return n}});let n=(0,s(8322).Z)("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},2531:function(t,e,s){"use strict";s.d(e,{Z:function(){return n}});let n=(0,s(8322).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},2133:function(t,e,s){"use strict";s.d(e,{Z:function(){return n}});let n=(0,s(8322).Z)("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])},8504:function(t,e,s){"use strict";var n=s(3226);s.o(n,"useParams")&&s.d(e,{useParams:function(){return n.useParams}}),s.o(n,"useRouter")&&s.d(e,{useRouter:function(){return n.useRouter}}),s.o(n,"useSearchParams")&&s.d(e,{useSearchParams:function(){return n.useSearchParams}})},6281:function(t,e,s){"use strict";s.d(e,{R:function(){return o},m:function(){return a}});var n=s(2252),i=s(1384),r=s(7732),a=class extends i.F{#t;#e;#s;#n;constructor(t){super(),this.#t=t.client,this.mutationId=t.mutationId,this.#s=t.mutationCache,this.#e=[],this.state=t.state||o(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){this.#e.includes(t)||(this.#e.push(t),this.clearGcTimeout(),this.#s.notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){this.#e=this.#e.filter(e=>e!==t),this.scheduleGc(),this.#s.notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){this.#e.length||("pending"===this.state.status?this.scheduleGc():this.#s.remove(this))}continue(){return this.#n?.continue()??this.execute(this.state.variables)}async execute(t){let e=()=>{this.#i({type:"continue"})},s={client:this.#t,meta:this.options.meta,mutationKey:this.options.mutationKey};this.#n=(0,r.Mz)({fn:()=>this.options.mutationFn?this.options.mutationFn(t,s):Promise.reject(Error("No mutationFn found")),onFail:(t,e)=>{this.#i({type:"failed",failureCount:t,error:e})},onPause:()=>{this.#i({type:"pause"})},onContinue:e,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#s.canRun(this)});let n="pending"===this.state.status,i=!this.#n.canStart();try{if(n)e();else{this.#i({type:"pending",variables:t,isPaused:i}),await this.#s.config.onMutate?.(t,this,s);let e=await this.options.onMutate?.(t,s);e!==this.state.context&&this.#i({type:"pending",context:e,variables:t,isPaused:i})}let r=await this.#n.start();return await this.#s.config.onSuccess?.(r,t,this.state.context,this,s),await this.options.onSuccess?.(r,t,this.state.context,s),await this.#s.config.onSettled?.(r,null,this.state.variables,this.state.context,this,s),await this.options.onSettled?.(r,null,t,this.state.context,s),this.#i({type:"success",data:r}),r}catch(e){try{throw await this.#s.config.onError?.(e,t,this.state.context,this,s),await this.options.onError?.(e,t,this.state.context,s),await this.#s.config.onSettled?.(void 0,e,this.state.variables,this.state.context,this,s),await this.options.onSettled?.(void 0,e,t,this.state.context,s),e}finally{this.#i({type:"error",error:e})}}finally{this.#s.runNext(this)}}#i(t){this.state=(e=>{switch(t.type){case"failed":return{...e,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...e,isPaused:!0};case"continue":return{...e,isPaused:!1};case"pending":return{...e,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...e,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...e,data:void 0,error:t.error,failureCount:e.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}})(this.state),n.Vr.batch(()=>{this.#e.forEach(e=>{e.onMutationUpdate(t)}),this.#s.notify({mutation:this,type:"updated",action:t})})}};function o(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}},8683:function(t,e,s){"use strict";s.d(e,{D:function(){return l}});var n=s(8078),i=s(6281),r=s(2252),a=s(2243),o=s(3506),c=class extends a.l{#t;#r=void 0;#a;#o;constructor(t,e){super(),this.#t=t,this.setOptions(e),this.bindMethods(),this.#c()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){let e=this.options;this.options=this.#t.defaultMutationOptions(t),(0,o.VS)(this.options,e)||this.#t.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#a,observer:this}),e?.mutationKey&&this.options.mutationKey&&(0,o.Ym)(e.mutationKey)!==(0,o.Ym)(this.options.mutationKey)?this.reset():this.#a?.state.status==="pending"&&this.#a.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#a?.removeObserver(this)}onMutationUpdate(t){this.#c(),this.#u(t)}getCurrentResult(){return this.#r}reset(){this.#a?.removeObserver(this),this.#a=void 0,this.#c(),this.#u()}mutate(t,e){return this.#o=e,this.#a?.removeObserver(this),this.#a=this.#t.getMutationCache().build(this.#t,this.options),this.#a.addObserver(this),this.#a.execute(t)}#c(){let t=this.#a?.state??(0,i.R)();this.#r={...t,isPending:"pending"===t.status,isSuccess:"success"===t.status,isError:"error"===t.status,isIdle:"idle"===t.status,mutate:this.mutate,reset:this.reset}}#u(t){r.Vr.batch(()=>{if(this.#o&&this.hasListeners()){let e=this.#r.variables,s=this.#r.context,n={client:this.#t,meta:this.options.meta,mutationKey:this.options.mutationKey};t?.type==="success"?(this.#o.onSuccess?.(t.data,e,s,n),this.#o.onSettled?.(t.data,null,e,s,n)):t?.type==="error"&&(this.#o.onError?.(t.error,e,s,n),this.#o.onSettled?.(void 0,t.error,e,s,n))}this.listeners.forEach(t=>{t(this.#r)})})}},u=s(8191);function l(t,e){let s=(0,u.NL)(e),[i]=n.useState(()=>new c(s,t));n.useEffect(()=>{i.setOptions(t)},[i,t]);let a=n.useSyncExternalStore(n.useCallback(t=>i.subscribe(r.Vr.batchCalls(t)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),l=n.useCallback((t,e)=>{i.mutate(t,e).catch(o.ZT)},[i]);if(a.error&&(0,o.L3)(i.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:l,mutateAsync:a.mutate}}}},function(t){t.O(0,[8803,5427,9808,6518,7115,2364,1744],function(){return t(t.s=7002)}),_N_E=t.O()}]);