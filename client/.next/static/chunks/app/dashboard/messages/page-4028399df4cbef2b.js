(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7091],{2923:function(e,t,r){Promise.resolve().then(r.bind(r,5273))},5273:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return T}});var a=r(7821),s=r(8078),n=r(8504),o=r(5427),i=r(6963),l=r(6393),c=r(5907),d=r(7419),u=r(9198),m=r(7211);function f(e){let{selectedConversationId:t,onConversationSelect:r,className:s}=e,{data:n,isLoading:f,error:x}=(0,o.a)({queryKey:["conversations"],queryFn:i.Jq.getConversations,refetchInterval:3e4}),g=e=>{try{let t=new Date(e),r=(new Date().getTime()-t.getTime())/36e5;if(r<24)return(0,c.WU)(t,"HH:mm");if(r<168)return(0,c.WU)(t,"EEE");return(0,c.WU)(t,"MMM d")}catch(e){return""}},h=e=>e.participants[0];if(f)return(0,a.jsx)("div",{className:(0,m.cn)("p-4",s),children:(0,a.jsx)("div",{className:"space-y-3",children:[void 0,void 0,void 0].map((e,t)=>(0,a.jsx)("div",{className:"animate-pulse",children:(0,a.jsx)("div",{className:"h-16 bg-gray-200 rounded-lg"})},t))})});if(x)return(0,a.jsx)("div",{className:(0,m.cn)("p-4",s),children:(0,a.jsx)("div",{className:"text-center text-red-500",children:"Failed to load conversations"})});let v=(null==n?void 0:n.conversations)||[];return 0===v.length?(0,a.jsxs)("div",{className:(0,m.cn)("p-4 text-center",s),children:[(0,a.jsx)(d.Z,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-900 mb-2",children:"No conversations yet"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Start a conversation by messaging a provider"})]}):(0,a.jsx)("div",{className:(0,m.cn)("divide-y divide-gray-200",s),children:v.map(e=>{var s;let n=h(e),o=t===e.id;return(0,a.jsx)("div",{className:(0,m.cn)("p-4 cursor-pointer hover:bg-gray-50 transition-colors",o&&"bg-blue-50 border-r-2 border-blue-500"),onClick:()=>r(e.id),children:(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("div",{className:"w-10 h-10 bg-gray-300 rounded-full flex items-center justify-center",children:(0,a.jsx)(u.Z,{className:"w-5 h-5 text-gray-600"})})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:n.email||"User"}),e.lastMessage&&(0,a.jsx)("p",{className:"text-xs text-gray-500",children:g(e.lastMessage.createdAt)})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between mt-1",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 truncate",children:(null===(s=e.lastMessage)||void 0===s?void 0:s.content)||"No messages yet"}),(0,a.jsx)(l.C,{variant:"secondary",className:"ml-2 text-xs",children:n.role.toLowerCase()})]})]})]})},e.id)})})}var x=r(7093),g=r(9926),h=r(1996),v=r(8149),p=r(5935),y=r(2828);function b(e){let{message:t,className:r,status:s="sent"}=e,{user:n}=(0,g.a)(),o=t.senderId===(null==n?void 0:n.id);return(0,a.jsx)("div",{className:(0,m.cn)("flex mb-4",o?"justify-end":"justify-start",r),children:(0,a.jsxs)("div",{className:(0,m.cn)("max-w-xs lg:max-w-md px-4 py-2 rounded-lg shadow-sm",o?"bg-blue-500 text-white rounded-br-none":"bg-gray-100 text-gray-900 rounded-bl-none"),children:[!o&&(0,a.jsx)("div",{className:"text-xs font-medium text-gray-600 mb-1",children:t.sender.email}),(0,a.jsx)("div",{className:"text-sm break-words",children:t.content}),(0,a.jsxs)("div",{className:(0,m.cn)("text-xs mt-1 flex items-center gap-1",o?"text-blue-100 justify-end":"text-gray-500 justify-start"),children:[(0,a.jsx)("span",{children:(e=>{try{return(0,c.WU)(new Date(e),"HH:mm")}catch(e){return""}})(t.createdAt)}),o&&(0,a.jsx)("span",{className:"flex items-center",title:"Message ".concat(s),children:(()=>{switch(s){case"sending":return(0,a.jsx)(h.Z,{className:"w-3 h-3 text-gray-400 animate-pulse"});case"sent":return(0,a.jsx)(v.Z,{className:"w-3 h-3 text-gray-400"});case"delivered":return(0,a.jsx)(p.Z,{className:"w-3 h-3 text-gray-400"});case"read":return(0,a.jsx)(p.Z,{className:"w-3 h-3 text-blue-500"});case"failed":return(0,a.jsx)(y.Z,{className:"w-3 h-3 text-red-500"});default:return null}})()})]})]})})}var j=r(5962);let w=s.forwardRef((e,t)=>{let{className:r,children:s,...n}=e;return(0,a.jsxs)(j.fC,{ref:t,className:(0,m.cn)("relative overflow-hidden",r),...n,children:[(0,a.jsx)(j.l_,{className:"h-full w-full rounded-[inherit]",children:s}),(0,a.jsx)(N,{}),(0,a.jsx)(j.Ns,{})]})});w.displayName=j.fC.displayName;let N=s.forwardRef((e,t)=>{let{className:r,orientation:s="vertical",...n}=e;return(0,a.jsx)(j.gb,{ref:t,orientation:s,className:(0,m.cn)("flex touch-none select-none transition-colors","vertical"===s&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===s&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",r),...n,children:(0,a.jsx)(j.q4,{className:"relative flex-1 rounded-full bg-border"})})});N.displayName=j.gb.displayName;var k=r(3842),S=r(5231),C=r(8006),A=r(7737),D=r(3061);function E(e){let{conversationId:t,className:r}=e,[n,l]=(0,s.useState)(""),c=(0,s.useRef)(null),d=(0,s.useRef)(null),{data:f,isLoading:h,error:v}=(0,o.a)({queryKey:["conversation",t,"messages"],queryFn:()=>i.Jq.getConversationMessages(t),enabled:!!t}),{messages:p,isConnected:y,isLoading:j,error:N,sendMessage:E}=function(e){let{conversationId:t}=e,{user:r}=(0,g.a)(),a=(0,s.useRef)(null),[n,o]=(0,s.useState)([]),[i,l]=(0,s.useState)(!1),[c,d]=(0,s.useState)(!1),[u,m]=(0,s.useState)(null),f=(0,s.useRef)(null);(0,s.useEffect)(()=>{let e=localStorage.getItem("auth_token");if(!e||!r)return;a.current=(0,x.io)("http://localhost:3001/api/v1",{auth:{token:e},transports:["websocket","polling"],timeout:1e4});let t=a.current;return t.on("connect",()=>{console.log("Connected to chat server"),l(!0),m(null)}),t.on("disconnect",e=>{console.log("Disconnected from chat server:",e),l(!1)}),t.on("connect_error",e=>{console.error("Connection error:",e),m("Failed to connect to chat server"),l(!1)}),t.on("joined_room",e=>{console.log("Joined conversation:",e.conversationId),f.current=e.conversationId}),t.on("receive_message",e=>{console.log("Received message:",e),o(t=>t.some(t=>t.id===e.message.id)?t:[...t,e.message].sort((e,t)=>new Date(e.createdAt).getTime()-new Date(t.createdAt).getTime()))}),t.on("message_sent",e=>{console.log("Message sent successfully:",e)}),t.on("error",e=>{console.error("Socket error:",e),m(e.message||"An error occurred")}),()=>{t.disconnect(),a.current=null}},[r]);let h=(0,s.useCallback)(e=>{if(!a.current||!i){m("Not connected to chat server");return}f.current!==e&&(console.log("Joining conversation:",e),a.current.emit("join_room",e))},[i]),v=(0,s.useCallback)(()=>{f.current=null},[]),p=(0,s.useCallback)(async e=>{if(!a.current||!i)throw Error("Not connected to chat server");if(!t)throw Error("No conversation selected");if(!e||0===e.trim().length)throw Error("Message content cannot be empty");if(e.length>1e3)throw Error("Message content cannot exceed 1000 characters");d(!0),m(null);try{a.current.emit("send_message",{conversationId:t,content:e.trim()})}catch(e){throw m(e instanceof Error?e.message:"Failed to send message"),e}finally{d(!1)}},[t,i]);return(0,s.useEffect)(()=>{t&&i&&h(t)},[t,i,h]),{messages:n,isConnected:i,isLoading:c,error:u,sendMessage:p,joinConversation:h,leaveConversation:v}}({conversationId:t}),_=s.useMemo(()=>{let e=[...(null==f?void 0:f.messages)||[]];return p.forEach(t=>{e.some(e=>e.id===t.id)||e.push(t)}),e.sort((e,t)=>new Date(e.createdAt).getTime()-new Date(t.createdAt).getTime())},[null==f?void 0:f.messages,p]);(0,s.useEffect)(()=>{var e;null===(e=c.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[_]),(0,s.useEffect)(()=>{t&&d.current&&d.current.focus()},[t]),(0,s.useEffect)(()=>{N&&D.Am.error(N)},[N]);let R=async e=>{if(e.preventDefault(),n.trim()&&t)try{await E(n.trim()),l("")}catch(e){}};return t?h?(0,a.jsx)("div",{className:(0,m.cn)("flex items-center justify-center h-full",r),children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):v?(0,a.jsx)("div",{className:(0,m.cn)("flex items-center justify-center h-full",r),children:(0,a.jsx)("div",{className:"text-center text-red-500",children:"Failed to load conversation"})}):(0,a.jsxs)(C.Zb,{className:(0,m.cn)("flex flex-col h-full",r),children:[(0,a.jsx)(C.Ol,{className:"border-b",children:(0,a.jsxs)(C.ll,{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-gray-300 rounded-full flex items-center justify-center",children:(0,a.jsx)(u.Z,{className:"w-4 h-4 text-gray-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm font-medium",children:"Chat"}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:y?"Online":"Offline"})]})]})}),(0,a.jsx)(C.aY,{className:"flex-1 p-0",children:(0,a.jsx)(w,{className:"h-full p-4",children:0===_.length?(0,a.jsx)("div",{className:"flex items-center justify-center h-full text-center px-4",children:(0,a.jsxs)("div",{className:"max-w-sm",children:[(0,a.jsx)("div",{className:"text-4xl mb-3",children:"\uD83D\uDC4B"}),(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Start the conversation"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 leading-relaxed",children:"Send a message to get started. You can discuss service details, availability, or any questions you have."}),(0,a.jsx)("div",{className:"mt-3 text-xs text-gray-400",children:"\uD83D\uDCA1 Tip: Be friendly and professional to build trust with your clients"})]})}):(0,a.jsxs)("div",{className:"space-y-2",children:[_.map(e=>(0,a.jsx)(b,{message:e},e.id)),(0,a.jsx)("div",{ref:c})]})})}),(0,a.jsx)("div",{className:"border-t p-4",children:(0,a.jsxs)("form",{onSubmit:R,className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsxs)("div",{className:"flex-1 relative",children:[(0,a.jsx)(S.I,{ref:d,type:"text",placeholder:"Type your message...",value:n,onChange:e=>l(e.target.value),className:"pr-12",maxLength:1e3,disabled:j||!y,onKeyDown:e=>{"Enter"===e.key&&!e.shiftKey&&(e.preventDefault(),n.trim()&&!j&&y&&R(e))}}),n.length>800&&(0,a.jsx)("div",{className:"absolute right-2 top-1/2 -translate-y-1/2",children:(0,a.jsxs)("span",{className:"text-xs ".concat(n.length>950?"text-red-500":"text-gray-400"),children:[n.length,"/1000"]})})]}),(0,a.jsxs)(k.z,{type:"submit",size:"sm",disabled:j||!n.trim()||!y,className:"px-3",children:[j?(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):(0,a.jsx)(A.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{className:"sr-only",children:j?"Sending message":"Send message"})]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center text-xs",children:[y?j?(0,a.jsxs)("p",{className:"text-blue-600 flex items-center gap-1",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-3 w-3 border-b border-blue-600"}),"Sending message..."]}):(0,a.jsx)("p",{className:"text-gray-400",children:"Press Enter to send, Shift+Enter for new line"}):(0,a.jsxs)("p",{className:"text-red-500 flex items-center gap-1",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse"}),"Disconnected from chat server"]}),n.length>0&&n.length<=800&&(0,a.jsxs)("span",{className:"text-gray-400",children:[n.length,"/1000"]})]})]})})]}):(0,a.jsx)("div",{className:(0,m.cn)("flex items-center justify-center h-full",r),children:(0,a.jsxs)("div",{className:"text-center max-w-sm mx-auto px-4",children:[(0,a.jsx)("div",{className:"text-6xl mb-4",children:"\uD83D\uDCAC"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Start a conversation"}),(0,a.jsx)("p",{className:"text-gray-500 text-sm leading-relaxed",children:"Select a conversation from the sidebar or wait for pet owners/providers to reach out to you."}),(0,a.jsx)("div",{className:"mt-4 text-xs text-gray-400",children:"\uD83D\uDCA1 Tip: Conversations appear here when someone books your services"})]})})}var _=r(5319),R=r(1306);let B=e=>{let{className:t,...r}=e;return(0,a.jsx)(R.eh,{className:(0,m.cn)("flex h-full w-full data-[panel-group-direction=vertical]:flex-col",t),...r})},I=R.s_,M=e=>{let{withHandle:t,className:r,...s}=e;return(0,a.jsx)(R.OT,{className:(0,m.cn)("relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90",r),...s,children:t&&(0,a.jsx)("div",{className:"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border",children:(0,a.jsx)(_.Z,{className:"h-2.5 w-2.5"})})})};var P=r(2806);function T(){let{user:e,isAuthenticated:t}=(0,g.a)(),r=(0,n.useRouter)(),o=(0,n.useSearchParams)(),[i,l]=(0,s.useState)(null);return((0,s.useEffect)(()=>{let e=o.get("conversationId");e&&l(e)},[o]),(0,s.useEffect)(()=>{t||null!==e||r.push("/login")},[t,e,r]),t)?(0,a.jsx)("div",{className:"h-[calc(100vh-4rem)] bg-gray-50",children:(0,a.jsxs)("div",{className:"h-full p-4",children:[(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsx)(P.aG,{children:(0,a.jsxs)(P.Jb,{children:[(0,a.jsx)(P.gN,{children:(0,a.jsx)(P.At,{href:"/",children:"Home"})}),(0,a.jsx)(P.bg,{}),(0,a.jsx)(P.gN,{children:(0,a.jsx)(P.At,{href:"/dashboard",children:"Dashboard"})}),(0,a.jsx)(P.bg,{}),(0,a.jsx)(P.gN,{children:(0,a.jsx)(P.AG,{children:"Messages"})})]})})}),(0,a.jsx)("div",{className:"h-full bg-white rounded-lg shadow-sm border",children:(0,a.jsxs)(B,{direction:"horizontal",className:"h-full",children:[(0,a.jsx)(I,{defaultSize:30,minSize:25,maxSize:40,children:(0,a.jsxs)("div",{className:"h-full border-r",children:[(0,a.jsxs)("div",{className:"p-4 border-b bg-gray-50",children:[(0,a.jsx)("h1",{className:"text-lg font-semibold text-gray-900",children:"Messages"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Chat with service providers"})]}),(0,a.jsx)(f,{selectedConversationId:i||void 0,onConversationSelect:e=>{l(e);let t=new URL(window.location.href);t.searchParams.set("conversationId",e),window.history.replaceState({},"",t.toString())},className:"h-[calc(100%-5rem)]"})]})}),(0,a.jsx)(M,{withHandle:!0}),(0,a.jsx)(I,{defaultSize:70,children:(0,a.jsx)(E,{conversationId:i,className:"h-full"})})]})})]})}):(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})})}},6393:function(e,t,r){"use strict";r.d(t,{C:function(){return i}});var a=r(7821);r(8078);var s=r(898),n=r(7211);let o=(0,s.j)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:t,variant:r,...s}=e;return(0,a.jsx)("div",{className:(0,n.cn)(o({variant:r}),t),...s})}},2806:function(e,t,r){"use strict";r.d(t,{AG:function(){return f},At:function(){return m},Jb:function(){return d},aG:function(){return c},bg:function(){return x},gN:function(){return u}});var a=r(7821),s=r(8078),n=r(2625),o=r(898),i=r(7211);let l=(0,o.j)("flex items-center gap-1.5",{variants:{variant:{default:"",ghost:"text-muted-foreground hover:text-foreground"}},defaultVariants:{variant:"default"}}),c=s.forwardRef((e,t)=>{let{className:r,variant:s,separator:o=n.Z,...c}=e;return(0,a.jsx)("nav",{ref:t,"aria-label":"breadcrumb",className:(0,i.cn)(l({variant:s}),r),...c})});c.displayName="Breadcrumb";let d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("ol",{ref:t,className:(0,i.cn)("flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5",r),...s})});d.displayName="BreadcrumbList";let u=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("li",{ref:t,className:(0,i.cn)("inline-flex items-center gap-1.5",r),...s})});u.displayName="BreadcrumbItem";let m=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("a",{ref:t,className:(0,i.cn)("transition-colors hover:text-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",r),...s})});m.displayName="BreadcrumbLink";let f=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("span",{ref:t,role:"link","aria-disabled":"true","aria-current":"page",className:(0,i.cn)("font-normal text-foreground",r),...s})});f.displayName="BreadcrumbPage";let x=e=>{let{children:t,className:r,...s}=e;return(0,a.jsx)("li",{role:"presentation","aria-hidden":"true",className:(0,i.cn)("[&>svg]:h-3.5 [&>svg]:w-3.5",r),...s,children:null!=t?t:(0,a.jsx)(n.Z,{})})};x.displayName="BreadcrumbSeparator"},3842:function(e,t,r){"use strict";r.d(t,{d:function(){return l},z:function(){return c}});var a=r(7821),s=r(8078),n=r(7035),o=r(898),i=r(7211);let l=(0,o.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),c=s.forwardRef((e,t)=>{let{className:r,variant:s,size:o,asChild:c=!1,...d}=e,u=c?n.g7:"button";return(0,a.jsx)(u,{className:(0,i.cn)(l({variant:s,size:o,className:r})),ref:t,...d})});c.displayName="Button"},8006:function(e,t,r){"use strict";r.d(t,{Ol:function(){return i},SZ:function(){return c},Zb:function(){return o},aY:function(){return d},eW:function(){return u},ll:function(){return l}});var a=r(7821),s=r(8078),n=r(7211);let o=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("rounded-xl border bg-card text-card-foreground shadow",r),...s})});o.displayName="Card";let i=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",r),...s})});i.displayName="CardHeader";let l=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("font-semibold leading-none tracking-tight",r),...s})});l.displayName="CardTitle";let c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",r),...s})});c.displayName="CardDescription";let d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",r),...s})});d.displayName="CardContent";let u=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",r),...s})});u.displayName="CardFooter"},5231:function(e,t,r){"use strict";r.d(t,{I:function(){return o}});var a=r(7821),s=r(8078),n=r(7211);let o=s.forwardRef((e,t)=>{let{className:r,type:s,...o}=e;return(0,a.jsx)("input",{type:s,className:(0,n.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:t,...o})});o.displayName="Input"},9926:function(e,t,r){"use strict";r.d(t,{H:function(){return c},a:function(){return d}});var a=r(7821),s=r(8078),n=r(6963),o=r(8191),i=r(5427);let l=(0,s.createContext)(void 0);function c(e){let{children:t}=e,r=(0,o.NL)(),{data:s,isLoading:c,isError:d}=(0,i.a)({queryKey:["auth","me"],queryFn:async()=>{console.log("[AuthContext DEBUG] Starting getMe query");{let e=localStorage.getItem("auth_token");if(console.log("[AuthContext DEBUG] Token from localStorage:",e?"found":"NOT FOUND"),!e)throw console.log("[AuthContext DEBUG] No token found, throwing error"),Error("No token found");console.log("[AuthContext DEBUG] Token exists, calling authAPI.getMe()")}return await n.kv.getMe()},retry:1,refetchOnWindowFocus:!1});console.log("[AuthContext DEBUG] Query state - user:",s,"isLoading:",c,"isError:",d);let u=!!s&&!d;return console.log("[AuthContext DEBUG] isAuthenticated calculated as:",u),(0,a.jsx)(l.Provider,{value:{user:s||null,isLoading:c,isAuthenticated:u,logout:()=>{console.log("[AuthContext DEBUG] logout() called"),localStorage.removeItem("auth_token"),localStorage.removeItem("refresh_token"),console.log("[AuthContext DEBUG] Tokens removed from localStorage"),r.invalidateQueries({queryKey:["auth","me"]}),console.log("[AuthContext DEBUG] Query cache invalidated")}},children:t})}function d(){let e=(0,s.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},7211:function(e,t,r){"use strict";r.d(t,{cn:function(){return n}});var a=r(2605),s=r(1638);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.m6)((0,a.W)(t))}},6963:function(e,t,r){"use strict";r.d(t,{FZ:function(){return i},Jq:function(){return u},RW:function(){return l},hi:function(){return n},kv:function(){return o},rg:function(){return d},wQ:function(){return c}});var a=r(9190);let s="http://localhost:3001/api/v1";console.log("[CLIENT DEBUG] API_BASE_URL: ".concat(s));let n=a.Z.create({baseURL:s,timeout:1e4,headers:{"Content-Type":"application/json"}});n.interceptors.request.use(e=>{{let t=localStorage.getItem("auth_token");t&&(e.headers.Authorization="Bearer ".concat(t))}return e},e=>Promise.reject(e)),n.interceptors.response.use(e=>e,async e=>{var t;let r=e.config;if((null===(t=e.response)||void 0===t?void 0:t.status)===401&&!r._retry){r._retry=!0;try{let t=localStorage.getItem("refresh_token");if(!t)return localStorage.removeItem("auth_token"),window.location.href="/login",Promise.reject(e);let{data:o}=await a.Z.post("".concat(s,"/auth/refresh"),{refreshToken:t}),{token:i,refreshToken:l}=o;return localStorage.setItem("auth_token",i),l&&localStorage.setItem("refresh_token",l),n.defaults.headers.common.Authorization="Bearer ".concat(i),r.headers.Authorization="Bearer ".concat(i),n(r)}catch(e){return console.error("Refresh token failed:",e),localStorage.removeItem("auth_token"),localStorage.removeItem("refresh_token"),window.location.href="/login",Promise.reject(e)}}return Promise.reject(e)});let o={login:async e=>(await n.post("/auth/login",e)).data.data,register:async e=>(await n.post("/auth/register",e)).data.data,getMe:async()=>(await n.get("/auth/me")).data.data},i={getMyProfile:async()=>(await n.get("/profiles/me")).data.data,updateMyProfile:async e=>(await n.put("/profiles/me",e)).data.data,createMyProfile:async e=>(await n.post("/profiles/me",e)).data.data,getProviderProfile:async e=>(await n.get("/profiles/provider/".concat(e))).data.data},l={createService:async e=>(await n.post("/services",e)).data.data,getMyServices:async()=>(await n.get("/services/my")).data.data,updateService:async(e,t)=>(await n.put("/services/".concat(e),t)).data.data,deleteService:async e=>{await n.delete("/services/".concat(e))},getServices:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,r=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0,o=arguments.length>5?arguments[5]:void 0,i={page:e,limit:t};return r&&(i.search=r),a&&(i.serviceType=a),s&&(i.location=s),o&&(i.date=o),(await n.get("/services",{params:i})).data.data},getTopRatedProviders:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return(await n.get("/services/top-rated-providers",{params:{limit:e}})).data.data},getService:async e=>(await n.get("/services/".concat(e))).data.data},c={createBooking:async(e,t)=>(await n.post("/bookings/service/".concat(e),t)).data.data,getMyBookingsAsOwner:async()=>(await n.get("/bookings/my-as-owner")).data.data,getMyBookingsAsProvider:async()=>(await n.get("/bookings/my-as-provider")).data.data,updateBookingStatus:async(e,t)=>(await n.put("/bookings/".concat(e,"/status"),t)).data.data},d={createReview:async(e,t)=>(await n.post("/reviews/booking/".concat(e),t)).data.data,getServiceReviews:async e=>(await n.get("/reviews/service/".concat(e))).data.data,getProviderReviews:async e=>(await n.get("/reviews/provider/".concat(e))).data.data,canReviewBooking:async e=>(await n.get("/reviews/booking/".concat(e,"/can-review"))).data.data},u={getConversations:async()=>(await n.get("/conversations")).data.data,createConversationWithProvider:async e=>(await n.post("/conversations/provider/".concat(e))).data.data,getConversationMessages:async e=>(await n.get("/conversations/".concat(e,"/messages"))).data.data}}},function(e){e.O(0,[8803,5427,60,3061,7212,7115,2364,1744],function(){return e(e.s=2923)}),_N_E=e.O()}]);