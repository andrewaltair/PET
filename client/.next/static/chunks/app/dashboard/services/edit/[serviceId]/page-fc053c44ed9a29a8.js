(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8614],{9965:function(e,t,s){Promise.resolve().then(s.bind(s,1690))},1690:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return f}});var i=s(7821),r=s(8078),a=s(8504),n=s(9926),o=s(1458),l=s(9008),c=s(6066),d=s(4852),u=s(3842),h=s(5231),p=s(9367),m=s(3529);function v(){let{user:e}=(0,n.a)(),t=(0,a.useRouter)(),s=(0,a.useParams)().serviceId,{data:c,isPending:v,error:f}=(0,o.G2)(s),y=(0,o.LR)(),[x,b]=(0,r.useState)({serviceType:l.ServiceType.WALKING,title:"",description:"",price:0,availability:{}}),[g,j]=(0,r.useState)({}),N=["08:00-09:00","09:00-10:00","10:00-11:00","11:00-12:00","12:00-13:00","13:00-14:00","14:00-15:00","15:00-16:00","16:00-17:00","17:00-18:00","18:00-19:00","19:00-20:00"],S=[{value:l.ServiceType.WALKING,label:"Dog Walking"},{value:l.ServiceType.SITTING,label:"Pet Sitting"},{value:l.ServiceType.GROOMING,label:"Grooming"},{value:l.ServiceType.VETERINARIAN_VISIT,label:"Veterinarian Visit"},{value:l.ServiceType.TAXI,label:"Pet Taxi"},{value:l.ServiceType.TRAINING,label:"Training"}];(0,r.useEffect)(()=>{c&&b({serviceType:c.serviceType,title:c.title,description:c.description,price:c.price,availability:c.availability})},[c]);let w=(e,t)=>{b(s=>({...s,[e]:t})),g[e]&&j(t=>({...t,[e]:""}))},R=(e,t)=>{b(s=>({...s,availability:{...s.availability,[e]:t}}))},T=()=>{let e={};return void 0===x.title||x.title.trim()?void 0!==x.title&&x.title.length<5&&(e.title="Title must be at least 5 characters"):e.title="Title is required",void 0===x.description||x.description.trim()?void 0!==x.description&&x.description.length<10&&(e.description="Description must be at least 10 characters"):e.description="Description is required",void 0!==x.price&&x.price<=0&&(e.price="Price must be greater than 0"),j(e),0===Object.keys(e).length},D=async e=>{if(e.preventDefault(),T())try{await y.mutateAsync({serviceId:s,serviceData:x}),t.push("/dashboard/services")}catch(e){}},E=()=>{t.push("/dashboard/services")};return(null==e?void 0:e.role)!==l.UserRole.PROVIDER?(0,i.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("div",{className:"text-6xl mb-4",children:"\uD83D\uDEAB"}),(0,i.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Access Denied"}),(0,i.jsx)("p",{className:"text-gray-600 mb-6",children:"Only service providers can edit services."}),(0,i.jsx)(u.z,{onClick:()=>t.push("/dashboard"),variant:"outline",children:"Back to Dashboard"})]})}):v?(0,i.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,i.jsx)(d.T,{size:"lg"})}):f?(0,i.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("div",{className:"text-red-600 text-lg font-semibold mb-2",children:"Failed to load service"}),(0,i.jsx)("p",{className:"text-gray-600 mb-4",children:f instanceof Error?f.message:"Unknown error occurred"}),(0,i.jsx)(u.z,{onClick:()=>t.push("/dashboard/services"),variant:"outline",children:"Back to Services"})]})}):c?(0,i.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,i.jsxs)("div",{className:"max-w-4xl mx-auto px-4",children:[(0,i.jsxs)("div",{className:"mb-8",children:[(0,i.jsx)("button",{onClick:E,className:"text-blue-600 hover:text-blue-800 mb-4 inline-block",children:"â† Back to Services"}),(0,i.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Edit Service"}),(0,i.jsx)("p",{className:"text-gray-600 mt-2",children:"Update your service details and availability"})]}),(0,i.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6",children:(0,i.jsxs)("form",{onSubmit:D,className:"space-y-6",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(p._,{htmlFor:"serviceType",children:"Service Type"}),(0,i.jsxs)(m.Ph,{value:x.serviceType,onValueChange:e=>w("serviceType",e),children:[(0,i.jsx)(m.i4,{children:(0,i.jsx)(m.ki,{placeholder:"Select service type"})}),(0,i.jsx)(m.Bw,{children:S.map(e=>(0,i.jsx)(m.Ql,{value:e.value,children:e.label},e.value))})]})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(p._,{htmlFor:"title",children:"Service Title"}),(0,i.jsx)(h.I,{type:"text",id:"title",value:x.title,onChange:e=>w("title",e.target.value),placeholder:"e.g., Premium Dog Walking Service"}),g.title&&(0,i.jsx)("p",{className:"text-destructive text-sm",children:g.title})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(p._,{htmlFor:"description",children:"Description"}),(0,i.jsx)("textarea",{id:"description",value:x.description,onChange:e=>w("description",e.target.value),className:"flex min-h-[120px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",placeholder:"Describe your service in detail...",rows:5}),g.description&&(0,i.jsx)("p",{className:"text-destructive text-sm",children:g.description})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(p._,{htmlFor:"price",children:"Price per Service ($)"}),(0,i.jsx)(h.I,{type:"number",id:"price",value:x.price||"",onChange:e=>w("price",parseFloat(e.target.value)||0),placeholder:"25.00",min:"0",step:"0.01"}),g.price&&(0,i.jsx)("p",{className:"text-destructive text-sm",children:g.price})]}),(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(p._,{children:"Availability"}),(0,i.jsx)("p",{className:"text-gray-600 text-sm mb-4",children:"Select the days and time slots when you're available for this service."})]}),(0,i.jsx)("div",{className:"space-y-4",children:[{key:"monday",label:"Monday"},{key:"tuesday",label:"Tuesday"},{key:"wednesday",label:"Wednesday"},{key:"thursday",label:"Thursday"},{key:"friday",label:"Friday"},{key:"saturday",label:"Saturday"},{key:"sunday",label:"Sunday"}].map(e=>{var t,s;return(0,i.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,i.jsx)("span",{className:"font-medium text-gray-900",children:e.label}),(0,i.jsxs)("span",{className:"text-sm text-gray-500",children:[(null===(s=x.availability)||void 0===s?void 0:null===(t=s[e.key])||void 0===t?void 0:t.length)||0," slots selected"]})]}),(0,i.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2",children:N.map(t=>{var s,r;let a=(null===(r=x.availability)||void 0===r?void 0:null===(s=r[e.key])||void 0===s?void 0:s.includes(t))||!1;return(0,i.jsx)("button",{type:"button",onClick:()=>{var s;let i=(null===(s=x.availability)||void 0===s?void 0:s[e.key])||[],r=a?i.filter(e=>e!==t):[...i,t];R(e.key,r)},className:"px-3 py-2 text-sm rounded-md border transition-colors ".concat(a?"bg-blue-100 border-blue-300 text-blue-800":"bg-white border-gray-300 text-gray-700 hover:bg-gray-50"),children:t},t)})})]},e.key)})})]}),(0,i.jsxs)("div",{className:"flex justify-end space-x-4 pt-6 border-t",children:[(0,i.jsx)(u.z,{type:"button",onClick:E,variant:"outline",disabled:y.isPending,children:"Cancel"}),(0,i.jsx)(u.z,{type:"submit",disabled:y.isPending,children:y.isPending?"Saving...":"Save Changes"})]})]})})]})}):(0,i.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("div",{className:"text-6xl mb-4",children:"\uD83D\uDD0D"}),(0,i.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Service Not Found"}),(0,i.jsx)("p",{className:"text-gray-600 mb-6",children:"The service you're trying to edit doesn't exist."}),(0,i.jsx)(u.z,{onClick:()=>t.push("/dashboard/services"),variant:"outline",children:"Back to Services"})]})})}function f(){return(0,i.jsx)(c.i,{children:(0,i.jsx)(v,{})})}},4852:function(e,t,s){"use strict";s.d(t,{T:function(){return r}});var i=s(7821);function r(e){let{size:t="md",className:s=""}=e;return(0,i.jsx)("div",{className:"flex justify-center items-center ".concat(s),children:(0,i.jsx)("div",{className:"".concat({sm:"w-4 h-4",md:"w-8 h-8",lg:"w-12 h-12"}[t]," border-2 border-gray-300 border-t-blue-600 rounded-full animate-spin")})})}s(8078)},6066:function(e,t,s){"use strict";s.d(t,{i:function(){return n}});var i=s(7821),r=s(8078),a=s(9926);function n(e){let{children:t}=e,{isAuthenticated:s,isLoading:n}=(0,a.a)();return(console.log("[ProtectedRoute DEBUG] Render - isAuthenticated:",s,"isLoading:",n),(0,r.useEffect)(()=>{console.log("[ProtectedRoute DEBUG] useEffect triggered - isLoading:",n,"isAuthenticated:",s),n||s?!n&&s&&console.log("[ProtectedRoute DEBUG] User is authenticated, allowing access"):(console.log("[ProtectedRoute DEBUG] Not authenticated, redirecting to /login"),window.location.href="/login")},[s,n]),n)?(console.log("[ProtectedRoute DEBUG] Still loading, showing loading spinner"),(0,i.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,i.jsx)("p",{className:"text-gray-600",children:"Loading..."})]})})):s?(console.log("[ProtectedRoute DEBUG] Rendering protected content"),(0,i.jsx)(i.Fragment,{children:t})):(console.log("[ProtectedRoute DEBUG] Not authenticated, returning null"),null)}},5231:function(e,t,s){"use strict";s.d(t,{I:function(){return n}});var i=s(7821),r=s(8078),a=s(7211);let n=r.forwardRef((e,t)=>{let{className:s,type:r,...n}=e;return(0,i.jsx)("input",{type:r,className:(0,a.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...n})});n.displayName="Input"},9367:function(e,t,s){"use strict";s.d(t,{_:function(){return c}});var i=s(7821),r=s(8078),a=s(5641),n=s(898),o=s(7211);let l=(0,n.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,i.jsx)(a.f,{ref:t,className:(0,o.cn)(l(),s),...r})});c.displayName=a.f.displayName},3529:function(e,t,s){"use strict";s.d(t,{Bw:function(){return v},Ph:function(){return d},Ql:function(){return f},i4:function(){return h},ki:function(){return u}});var i=s(7821),r=s(8078),a=s(3517),n=s(4713),o=s(8134),l=s(8149),c=s(7211);let d=a.fC;a.ZA;let u=a.B4,h=r.forwardRef((e,t)=>{let{className:s,children:r,...o}=e;return(0,i.jsxs)(a.xz,{ref:t,className:(0,c.cn)("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...o,children:[r,(0,i.jsx)(a.JO,{asChild:!0,children:(0,i.jsx)(n.Z,{className:"h-4 w-4 opacity-50"})})]})});h.displayName=a.xz.displayName;let p=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,i.jsx)(a.u_,{ref:t,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",s),...r,children:(0,i.jsx)(o.Z,{className:"h-4 w-4"})})});p.displayName=a.u_.displayName;let m=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,i.jsx)(a.$G,{ref:t,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",s),...r,children:(0,i.jsx)(n.Z,{className:"h-4 w-4"})})});m.displayName=a.$G.displayName;let v=r.forwardRef((e,t)=>{let{className:s,children:r,position:n="popper",...o}=e;return(0,i.jsx)(a.h_,{children:(0,i.jsxs)(a.VY,{ref:t,className:(0,c.cn)("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:n,...o,children:[(0,i.jsx)(p,{}),(0,i.jsx)(a.l_,{className:(0,c.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,i.jsx)(m,{})]})})});v.displayName=a.VY.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,i.jsx)(a.__,{ref:t,className:(0,c.cn)("px-2 py-1.5 text-sm font-semibold",s),...r})}).displayName=a.__.displayName;let f=r.forwardRef((e,t)=>{let{className:s,children:r,...n}=e;return(0,i.jsxs)(a.ck,{ref:t,className:(0,c.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...n,children:[(0,i.jsx)("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,i.jsx)(a.wU,{children:(0,i.jsx)(l.Z,{className:"h-4 w-4"})})}),(0,i.jsx)(a.eT,{children:r})]})});f.displayName=a.ck.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,i.jsx)(a.Z0,{ref:t,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",s),...r})}).displayName=a.Z0.displayName},7790:function(e,t,s){"use strict";s.d(t,{Am:function(){return u},pm:function(){return h}});var i=s(8078);let r=0,a=new Map,n=e=>{if(a.has(e))return;let t=setTimeout(()=>{a.delete(e),d({type:"REMOVE_TOAST",toastId:e})},1e6);a.set(e,t)},o=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:s}=t;return s?n(s):e.toasts.forEach(e=>{n(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===s||void 0===s?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},l=[],c={toasts:[]};function d(e){c=o(c,e),l.forEach(e=>{e(c)})}function u(e){let{...t}=e,s=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),i=()=>d({type:"DISMISS_TOAST",toastId:s});return d({type:"ADD_TOAST",toast:{...t,id:s,open:!0,onOpenChange:e=>{e||i()}}}),{id:s,dismiss:i,update:e=>d({type:"UPDATE_TOAST",toast:{...e,id:s}})}}function h(){let[e,t]=i.useState(c);return i.useEffect(()=>(l.push(t),()=>{let e=l.indexOf(t);e>-1&&l.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>d({type:"DISMISS_TOAST",toastId:e})}}},1458:function(e,t,s){"use strict";s.d(t,{$_:function(){return h},G2:function(){return p},LR:function(){return u},bu:function(){return d},v_:function(){return c}});var i=s(5427),r=s(8191),a=s(8683),n=s(6963),o=s(7790);let l={all:["services"],lists:()=>[...l.all,"list"],list:e=>[...l.lists(),e],myServices:()=>[...l.all,"my"],details:()=>[...l.all,"detail"],detail:e=>[...l.details(),e]};function c(){return(0,i.a)({queryKey:l.myServices(),queryFn:n.RW.getMyServices,staleTime:12e4,retry:(e,t)=>{var s,i;return(null==t?void 0:null===(s=t.response)||void 0===s?void 0:s.status)!==401&&(null==t?void 0:null===(i=t.response)||void 0===i?void 0:i.status)!==403&&e<3}})}function d(){let e=(0,r.NL)();return(0,a.D)({mutationFn:e=>n.RW.createService(e),onSuccess:t=>{e.invalidateQueries({queryKey:l.myServices()}),e.invalidateQueries({queryKey:l.lists()}),(0,o.Am)({title:"Success",description:"Service created successfully"})},onError:e=>{var t,s;let i=(null==e?void 0:null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.error)||"Failed to create service";(0,o.Am)({title:"Error",description:i,variant:"destructive"})}})}function u(){let e=(0,r.NL)();return(0,a.D)({mutationFn:e=>{let{serviceId:t,serviceData:s}=e;return n.RW.updateService(t,s)},onSuccess:(t,s)=>{let{serviceId:i}=s;e.setQueryData(l.myServices(),e=>e?e.map(e=>e.id===i?t:e):e),e.setQueryData(l.detail(i),t),e.invalidateQueries({queryKey:l.lists()}),(0,o.Am)({title:"Success",description:"Service updated successfully"})},onError:e=>{var t,s;let i=(null==e?void 0:null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.error)||"Failed to update service";(0,o.Am)({title:"Error",description:i,variant:"destructive"})}})}function h(){let e=(0,r.NL)();return(0,a.D)({mutationFn:e=>n.RW.deleteService(e),onSuccess:(t,s)=>{e.setQueryData(l.myServices(),e=>e?e.filter(e=>e.id!==s):e),e.removeQueries({queryKey:l.detail(s)}),e.invalidateQueries({queryKey:l.lists()}),(0,o.Am)({title:"Success",description:"Service deleted successfully"})},onError:e=>{var t,s;let i=(null==e?void 0:null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.error)||"Failed to delete service";(0,o.Am)({title:"Error",description:i,variant:"destructive"})}})}function p(e){return(0,i.a)({queryKey:l.detail(e),queryFn:()=>n.RW.getService(e),enabled:!!e,staleTime:3e5,retry:(e,t)=>{var s;return(null==t?void 0:null===(s=t.response)||void 0===s?void 0:s.status)!==404&&e<3}})}},5641:function(e,t,s){"use strict";s.d(t,{f:function(){return o}});var i=s(8078),r=s(3184),a=s(7821),n=i.forwardRef((e,t)=>(0,a.jsx)(r.WV.label,{...e,ref:t,onMouseDown:t=>{var s;t.target.closest("button, input, select, textarea")||(null===(s=e.onMouseDown)||void 0===s||s.call(e,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));n.displayName="Label";var o=n},6281:function(e,t,s){"use strict";s.d(t,{R:function(){return o},m:function(){return n}});var i=s(2252),r=s(1384),a=s(7732),n=class extends r.F{#e;#t;#s;#i;constructor(e){super(),this.#e=e.client,this.mutationId=e.mutationId,this.#s=e.mutationCache,this.#t=[],this.state=e.state||o(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){this.#t.includes(e)||(this.#t.push(e),this.clearGcTimeout(),this.#s.notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){this.#t=this.#t.filter(t=>t!==e),this.scheduleGc(),this.#s.notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){this.#t.length||("pending"===this.state.status?this.scheduleGc():this.#s.remove(this))}continue(){return this.#i?.continue()??this.execute(this.state.variables)}async execute(e){let t=()=>{this.#r({type:"continue"})},s={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};this.#i=(0,a.Mz)({fn:()=>this.options.mutationFn?this.options.mutationFn(e,s):Promise.reject(Error("No mutationFn found")),onFail:(e,t)=>{this.#r({type:"failed",failureCount:e,error:t})},onPause:()=>{this.#r({type:"pause"})},onContinue:t,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#s.canRun(this)});let i="pending"===this.state.status,r=!this.#i.canStart();try{if(i)t();else{this.#r({type:"pending",variables:e,isPaused:r}),await this.#s.config.onMutate?.(e,this,s);let t=await this.options.onMutate?.(e,s);t!==this.state.context&&this.#r({type:"pending",context:t,variables:e,isPaused:r})}let a=await this.#i.start();return await this.#s.config.onSuccess?.(a,e,this.state.context,this,s),await this.options.onSuccess?.(a,e,this.state.context,s),await this.#s.config.onSettled?.(a,null,this.state.variables,this.state.context,this,s),await this.options.onSettled?.(a,null,e,this.state.context,s),this.#r({type:"success",data:a}),a}catch(t){try{throw await this.#s.config.onError?.(t,e,this.state.context,this,s),await this.options.onError?.(t,e,this.state.context,s),await this.#s.config.onSettled?.(void 0,t,this.state.variables,this.state.context,this,s),await this.options.onSettled?.(void 0,t,e,this.state.context,s),t}finally{this.#r({type:"error",error:t})}}finally{this.#s.runNext(this)}}#r(e){this.state=(t=>{switch(e.type){case"failed":return{...t,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...t,isPaused:!0};case"continue":return{...t,isPaused:!1};case"pending":return{...t,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...t,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...t,data:void 0,error:e.error,failureCount:t.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}})(this.state),i.Vr.batch(()=>{this.#t.forEach(t=>{t.onMutationUpdate(e)}),this.#s.notify({mutation:this,type:"updated",action:e})})}};function o(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}},8683:function(e,t,s){"use strict";s.d(t,{D:function(){return d}});var i=s(8078),r=s(6281),a=s(2252),n=s(2243),o=s(3506),l=class extends n.l{#e;#a=void 0;#n;#o;constructor(e,t){super(),this.#e=e,this.setOptions(t),this.bindMethods(),this.#l()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){let t=this.options;this.options=this.#e.defaultMutationOptions(e),(0,o.VS)(this.options,t)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#n,observer:this}),t?.mutationKey&&this.options.mutationKey&&(0,o.Ym)(t.mutationKey)!==(0,o.Ym)(this.options.mutationKey)?this.reset():this.#n?.state.status==="pending"&&this.#n.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#n?.removeObserver(this)}onMutationUpdate(e){this.#l(),this.#c(e)}getCurrentResult(){return this.#a}reset(){this.#n?.removeObserver(this),this.#n=void 0,this.#l(),this.#c()}mutate(e,t){return this.#o=t,this.#n?.removeObserver(this),this.#n=this.#e.getMutationCache().build(this.#e,this.options),this.#n.addObserver(this),this.#n.execute(e)}#l(){let e=this.#n?.state??(0,r.R)();this.#a={...e,isPending:"pending"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset}}#c(e){a.Vr.batch(()=>{if(this.#o&&this.hasListeners()){let t=this.#a.variables,s=this.#a.context,i={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};e?.type==="success"?(this.#o.onSuccess?.(e.data,t,s,i),this.#o.onSettled?.(e.data,null,t,s,i)):e?.type==="error"&&(this.#o.onError?.(e.error,t,s,i),this.#o.onSettled?.(void 0,e.error,t,s,i))}this.listeners.forEach(e=>{e(this.#a)})})}},c=s(8191);function d(e,t){let s=(0,c.NL)(t),[r]=i.useState(()=>new l(s,e));i.useEffect(()=>{r.setOptions(e)},[r,e]);let n=i.useSyncExternalStore(i.useCallback(e=>r.subscribe(a.Vr.batchCalls(e)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),d=i.useCallback((e,t)=>{r.mutate(e,t).catch(o.ZT)},[r]);if(n.error&&(0,o.L3)(r.options.throwOnError,[n.error]))throw n.error;return{...n,mutate:d,mutateAsync:n.mutate}}}},function(e){e.O(0,[8803,5427,9808,6074,9033,4685,8531,6518,7115,2364,1744],function(){return e(e.s=9965)}),_N_E=e.O()}]);