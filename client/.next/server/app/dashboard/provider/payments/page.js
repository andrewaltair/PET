(()=>{var e={};e.id=643,e.ids=[643],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},44696:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>d,pages:()=>u,routeModule:()=>p,tree:()=>l}),s(47719),s(22399),s(12874);var r=s(27105),i=s(15265),a=s(90157),n=s.n(a),o=s(44665),c={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>o[e]);s.d(t,c);let l=["",{children:["dashboard",{children:["provider",{children:["payments",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,47719)),"C:\\Users\\User\\Desktop\\GITHUB\\PET\\client\\src\\app\\dashboard\\provider\\payments\\page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,22399)),"C:\\Users\\User\\Desktop\\GITHUB\\PET\\client\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,12874,23)),"next/dist/client/components/not-found-error"]}],u=["C:\\Users\\User\\Desktop\\GITHUB\\PET\\client\\src\\app\\dashboard\\provider\\payments\\page.tsx"],d="/dashboard/provider/payments/page",m={require:s,loadChunk:()=>Promise.resolve()},p=new r.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/dashboard/provider/payments/page",pathname:"/dashboard/provider/payments",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},91526:(e,t,s)=>{Promise.resolve().then(s.bind(s,27087))},27087:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>v});var r=s(19899);s(5507);var i=s(76153),a=s(65271),n=s(25220),o=s(23847),c=s(2345),l=s(4649),u=s(49614),d=s(83217),m=s(48026),p=s(93818),h=s(43956),x=s(40856);let g=(0,s(84516).Z)("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);function b(){let{user:e}=(0,a.a)(),t=(0,i.useRouter)(),{data:s,isPending:c,error:b}=(0,n.B9)(),v=(0,n.Wd)(),y=async()=>{try{let e=await v.mutateAsync();window.location.href=e.onboardingUrl}catch(e){console.error("Failed to create Stripe onboarding:",e)}};if(e?.role!==o.UserRole.PROVIDER)return r.jsx("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"text-6xl mb-4",children:"\uD83D\uDEAB"}),r.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Access Denied"}),r.jsx("p",{className:"text-gray-600 mb-6",children:"Only service providers can manage payment settings."}),r.jsx(u.z,{onClick:()=>t.push("/dashboard"),children:"Back to Dashboard"})]})});if(c)return r.jsx("div",{className:"min-h-screen flex items-center justify-center",children:r.jsx(l.T,{size:"lg"})});if(b)return r.jsx("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx(p.Z,{className:"mx-auto h-12 w-12 text-red-500 mb-4"}),r.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Error Loading Payment Settings"}),r.jsx("p",{className:"text-gray-600 mb-6",children:b instanceof Error?b.message:"Failed to load payment settings"}),r.jsx(u.z,{onClick:()=>t.push("/dashboard"),children:"Back to Dashboard"})]})});let f=s?.data?.onboardingComplete??!1,j=!!s?.data?.stripeAccountId;return r.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto px-4",children:[(0,r.jsxs)("div",{className:"mb-8",children:[r.jsx("button",{onClick:()=>t.push("/dashboard"),className:"text-blue-600 hover:text-blue-800 mb-4 inline-block",children:"← Back to Dashboard"}),r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Payment Settings"}),r.jsx("p",{className:"text-gray-600 mt-2",children:"Manage your Stripe account and payment preferences"})]}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)(d.Zb,{children:[(0,r.jsxs)(d.Ol,{children:[(0,r.jsxs)(d.ll,{className:"flex items-center gap-2",children:[r.jsx(h.Z,{className:"h-5 w-5"}),"Stripe Account Status"]}),r.jsx(d.SZ,{children:"Connect your Stripe account to receive payments from customers"})]}),(0,r.jsxs)(d.aY,{children:[f?(0,r.jsxs)("div",{className:"flex items-center gap-3 p-4 bg-green-50 border border-green-200 rounded-lg",children:[r.jsx(x.Z,{className:"h-5 w-5 text-green-600"}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"font-medium text-green-900",children:"Stripe Account Connected"}),r.jsx("p",{className:"text-sm text-green-700",children:"Your account is fully set up and ready to receive payments."})]})]}):j?(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)(m.bZ,{children:[r.jsx(p.Z,{className:"h-4 w-4"}),r.jsx(m.X,{children:"Your Stripe account is created but onboarding is not complete. Please complete the onboarding process to start receiving payments."})]}),r.jsx(u.z,{onClick:y,disabled:v.isPending,className:"w-full",children:v.isPending?(0,r.jsxs)(r.Fragment,{children:[r.jsx(l.T,{size:"sm",className:"mr-2"}),"Setting up..."]}):(0,r.jsxs)(r.Fragment,{children:[r.jsx(g,{className:"mr-2 h-4 w-4"}),"Complete Stripe Onboarding"]})})]}):(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)(m.bZ,{children:[r.jsx(p.Z,{className:"h-4 w-4"}),r.jsx(m.X,{children:"You need to connect your Stripe account to receive payments from customers. This is required to accept bookings and get paid."})]}),r.jsx(u.z,{onClick:y,disabled:v.isPending,className:"w-full",children:v.isPending?(0,r.jsxs)(r.Fragment,{children:[r.jsx(l.T,{size:"sm",className:"mr-2"}),"Connecting..."]}):(0,r.jsxs)(r.Fragment,{children:[r.jsx(g,{className:"mr-2 h-4 w-4"}),"Connect Stripe Account"]})})]}),v.error&&(0,r.jsxs)(m.bZ,{className:"mt-4",children:[r.jsx(p.Z,{className:"h-4 w-4"}),(0,r.jsxs)(m.X,{className:"text-red-600",children:["Failed to connect Stripe account: ",v.error.message]})]})]})]}),(0,r.jsxs)(d.Zb,{children:[(0,r.jsxs)(d.Ol,{children:[r.jsx(d.ll,{children:"Payment Information"}),r.jsx(d.SZ,{children:"How payments work on our platform"})]}),(0,r.jsxs)(d.aY,{children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center py-2 border-b",children:[r.jsx("span",{className:"text-sm font-medium",children:"Platform Commission"}),r.jsx("span",{className:"text-sm text-gray-600",children:"10%"})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center py-2 border-b",children:[r.jsx("span",{className:"text-sm font-medium",children:"Provider Receives"}),r.jsx("span",{className:"text-sm text-gray-600",children:"90%"})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center py-2",children:[r.jsx("span",{className:"text-sm font-medium",children:"Payout Schedule"}),r.jsx("span",{className:"text-sm text-gray-600",children:"Daily"})]})]}),r.jsx("p",{className:"text-xs text-gray-500 mt-4",children:"Payments are processed securely through Stripe. Funds are transferred to your connected bank account according to your payout schedule."})]})]})]})]})})}function v(){return r.jsx(c.i,{children:r.jsx(b,{})})}},4649:(e,t,s)=>{"use strict";s.d(t,{T:()=>i});var r=s(19899);function i({size:e="md",className:t=""}){return r.jsx("div",{className:`flex justify-center items-center ${t}`,children:r.jsx("div",{className:`${{sm:"w-4 h-4",md:"w-8 h-8",lg:"w-12 h-12"}[e]} border-2 border-gray-300 border-t-blue-600 rounded-full animate-spin`})})}s(5507)},2345:(e,t,s)=>{"use strict";s.d(t,{i:()=>a});var r=s(19899);s(5507);var i=s(65271);function a({children:e}){let{isAuthenticated:t,isLoading:s}=(0,i.a)();return(console.log("[ProtectedRoute DEBUG] Render - isAuthenticated:",t,"isLoading:",s),s)?(console.log("[ProtectedRoute DEBUG] Still loading, showing loading spinner"),r.jsx("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),r.jsx("p",{className:"text-gray-600",children:"Loading..."})]})})):t?(console.log("[ProtectedRoute DEBUG] Rendering protected content"),r.jsx(r.Fragment,{children:e})):(console.log("[ProtectedRoute DEBUG] Not authenticated, returning null"),null)}},48026:(e,t,s)=>{"use strict";s.d(t,{X:()=>l,bZ:()=>c});var r=s(19899),i=s(5507),a=s(51138),n=s(13096);let o=(0,a.j)("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),c=i.forwardRef(({className:e,variant:t,...s},i)=>r.jsx("div",{ref:i,role:"alert",className:(0,n.cn)(o({variant:t}),e),...s}));c.displayName="Alert",i.forwardRef(({className:e,...t},s)=>r.jsx("h5",{ref:s,className:(0,n.cn)("mb-1 font-medium leading-none tracking-tight",e),...t})).displayName="AlertTitle";let l=i.forwardRef(({className:e,...t},s)=>r.jsx("div",{ref:s,className:(0,n.cn)("text-sm [&_p]:leading-relaxed",e),...t}));l.displayName="AlertDescription"},25220:(e,t,s)=>{"use strict";s.d(t,{B9:()=>o,Wd:()=>c,aS:()=>l});var r=s(7346),i=s(1206),a=s(57623),n=s(67765);function o(){return(0,r.a)({queryKey:["stripe","account-status"],queryFn:async()=>(await n.hi.get("/stripe/connect/account-status")).data,enabled:!1})}function c(){let e=(0,i.NL)();return(0,a.D)({mutationFn:async()=>(await n.hi.post("/stripe/connect/onboard")).data.data,onSuccess:()=>{e.invalidateQueries({queryKey:["stripe","account-status"]})}})}function l(){return(0,a.D)({mutationFn:async e=>(await n.hi.post(`/bookings/${e}/create-payment-intent`)).data.data})}},40856:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(84516).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},43956:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(84516).Z)("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])},76153:(e,t,s)=>{"use strict";var r=s(81545);s.o(r,"useParams")&&s.d(t,{useParams:function(){return r.useParams}}),s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}}),s.o(r,"useSearchParams")&&s.d(t,{useSearchParams:function(){return r.useSearchParams}})},92640:(e,t,s)=>{"use strict";var r=Object.create?function(e,t,s,r){void 0===r&&(r=s);var i=Object.getOwnPropertyDescriptor(t,s);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,r,i)}:function(e,t,s,r){void 0===r&&(r=s),e[r]=t[s]};Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||r(t,e,s)}(s(81285),t)},81285:(e,t)=>{"use strict";var s,r,i,a;Object.defineProperty(t,"__esModule",{value:!0}),t.PaymentStatus=t.BookingStatus=t.ServiceType=t.UserRole=void 0,function(e){e.OWNER="OWNER",e.PROVIDER="PROVIDER"}(s||(t.UserRole=s={})),function(e){e.WALKING="WALKING",e.SITTING="SITTING",e.GROOMING="GROOMING",e.VETERINARIAN_VISIT="VETERINARIAN_VISIT",e.TAXI="TAXI",e.TRAINING="TRAINING"}(r||(t.ServiceType=r={})),function(e){e.PENDING="PENDING",e.CONFIRMED="CONFIRMED",e.CANCELLED="CANCELLED",e.COMPLETED="COMPLETED"}(i||(t.BookingStatus=i={})),function(e){e.PENDING="PENDING",e.PAID="PAID",e.FAILED="FAILED"}(a||(t.PaymentStatus=a={}))},23847:(e,t,s)=>{"use strict";var r=Object.create?function(e,t,s,r){void 0===r&&(r=s);var i=Object.getOwnPropertyDescriptor(t,s);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,r,i)}:function(e,t,s,r){void 0===r&&(r=s),e[r]=t[s]},i=function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||r(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),i(s(92640),t),i(s(90858),t),i(s(14188),t)},14188:(e,t,s)=>{"use strict";var r=Object.create?function(e,t,s,r){void 0===r&&(r=s);var i=Object.getOwnPropertyDescriptor(t,s);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,r,i)}:function(e,t,s,r){void 0===r&&(r=s),e[r]=t[s]};Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||r(t,e,s)}(s(44417),t)},44417:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateBookingStatusSchema=t.createBookingSchema=t.updateServiceSchema=t.createServiceSchema=t.updateProfileSchema=t.createProfileSchema=t.loginSchema=t.createUserSchema=void 0;let r=s(27490),i=s(92640);t.createUserSchema=r.z.object({email:r.z.string().email("Invalid email format"),password:r.z.string().min(8,"Password must be at least 8 characters"),role:r.z.nativeEnum(i.UserRole)}),t.loginSchema=r.z.object({email:r.z.string().email("Invalid email format"),password:r.z.string().min(1,"Password is required")}),t.createProfileSchema=r.z.object({userId:r.z.string().uuid(),firstName:r.z.string().min(1).max(50).optional(),lastName:r.z.string().min(1).max(50).optional(),avatarUrl:r.z.string().url().optional(),bio:r.z.string().max(500).optional(),location:r.z.string().max(100).optional()}),t.updateProfileSchema=r.z.object({firstName:r.z.string().min(1).max(50).optional(),lastName:r.z.string().min(1).max(50).optional(),avatarUrl:r.z.string().url().optional(),bio:r.z.string().max(500).optional(),location:r.z.string().max(100).optional()}),t.createServiceSchema=r.z.object({serviceType:r.z.nativeEnum(i.ServiceType),title:r.z.string().min(5).max(100),description:r.z.string().min(10).max(1e3),price:r.z.number().positive(),availability:r.z.record(r.z.array(r.z.string().regex(/^([01]\d|2[0-3]):([0-5]\d)-([01]\d|2[0-3]):([0-5]\d)$/)))}),t.updateServiceSchema=r.z.object({serviceType:r.z.nativeEnum(i.ServiceType).optional(),title:r.z.string().min(5).max(100).optional(),description:r.z.string().min(10).max(1e3).optional(),price:r.z.number().positive().optional(),availability:r.z.record(r.z.array(r.z.string().regex(/^([01]\d|2[0-3]):([0-5]\d)-([01]\d|2[0-3]):([0-5]\d)$/))).optional()}),t.createBookingSchema=r.z.object({bookingTime:r.z.string().datetime(),notes:r.z.string().max(500).optional()}),t.updateBookingStatusSchema=r.z.object({status:r.z.nativeEnum(i.BookingStatus)})},49883:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},71899:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},90858:(e,t,s)=>{"use strict";var r=Object.create?function(e,t,s,r){void 0===r&&(r=s);var i=Object.getOwnPropertyDescriptor(t,s);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,r,i)}:function(e,t,s,r){void 0===r&&(r=s),e[r]=t[s]},i=function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||r(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),i(s(29727),t),i(s(49883),t),i(s(66722),t),i(s(71899),t),i(s(19686),t)},19686:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},66722:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},29727:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},47719:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(2772).createProxy)(String.raw`C:\Users\User\Desktop\GITHUB\PET\client\src\app\dashboard\provider\payments\page.tsx#default`)},57623:(e,t,s)=>{"use strict";s.d(t,{D:()=>u});var r=s(5507),i=s(41922),a=s(16641),n=s(99028),o=s(67973),c=class extends n.l{#e;#t=void 0;#s;#r;constructor(e,t){super(),this.#e=e,this.setOptions(t),this.bindMethods(),this.#i()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){let t=this.options;this.options=this.#e.defaultMutationOptions(e),(0,o.VS)(this.options,t)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#s,observer:this}),t?.mutationKey&&this.options.mutationKey&&(0,o.Ym)(t.mutationKey)!==(0,o.Ym)(this.options.mutationKey)?this.reset():this.#s?.state.status==="pending"&&this.#s.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#s?.removeObserver(this)}onMutationUpdate(e){this.#i(),this.#a(e)}getCurrentResult(){return this.#t}reset(){this.#s?.removeObserver(this),this.#s=void 0,this.#i(),this.#a()}mutate(e,t){return this.#r=t,this.#s?.removeObserver(this),this.#s=this.#e.getMutationCache().build(this.#e,this.options),this.#s.addObserver(this),this.#s.execute(e)}#i(){let e=this.#s?.state??(0,i.R)();this.#t={...e,isPending:"pending"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset}}#a(e){a.Vr.batch(()=>{if(this.#r&&this.hasListeners()){let t=this.#t.variables,s=this.#t.context,r={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};e?.type==="success"?(this.#r.onSuccess?.(e.data,t,s,r),this.#r.onSettled?.(e.data,null,t,s,r)):e?.type==="error"&&(this.#r.onError?.(e.error,t,s,r),this.#r.onSettled?.(void 0,e.error,t,s,r))}this.listeners.forEach(e=>{e(this.#t)})})}},l=s(1206);function u(e,t){let s=(0,l.NL)(t),[i]=r.useState(()=>new c(s,e));r.useEffect(()=>{i.setOptions(e)},[i,e]);let n=r.useSyncExternalStore(r.useCallback(e=>i.subscribe(a.Vr.batchCalls(e)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),u=r.useCallback((e,t)=>{i.mutate(e,t).catch(o.ZT)},[i]);if(n.error&&(0,o.L3)(i.options.throwOnError,[n.error]))throw n.error;return{...n,mutate:u,mutateAsync:n.mutate}}}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[489,490,695],()=>s(44696));module.exports=r})();